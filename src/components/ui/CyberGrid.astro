---
// CyberGrid.astro - Wersja: "Perfect Center Immersion"
---

<div class="cyber-scene">
  <div class="grid-wrapper">
    <div class="grid-texture"></div>
  </div>
  
  <div class="horizon-dof"></div>
</div>

<style>
  .cyber-scene {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    perspective: 450px;
    overflow: hidden;
    pointer-events: none;
    background: transparent;

    mask-image: linear-gradient(to bottom, 
      transparent 0%, 
      transparent 50%, 
      black 90%, 
      black 100%
    );
    -webkit-mask-image: linear-gradient(to bottom, 
      transparent 0%, 
      transparent 50%, 
      black 90%, 
      black 100%
    );
  }

  .horizon-dof {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 60%;
    z-index: 10;
    backdrop-filter: blur(3px);
    -webkit-backdrop-filter: blur(3px);
    mask-image: linear-gradient(to bottom, black 0%, transparent 100%);
    -webkit-mask-image: linear-gradient(to bottom, black 0%, transparent 100%);
  }

  .grid-wrapper {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    transform: rotateX(80deg);
    transform-style: preserve-3d;
  }

  .grid-texture {
    position: absolute;
    top: -100%; 
    left: -100%;
    width: 300%;
    height: 300%;
    
    /* DEFAULT DESKTOP GRADIENTS */
    background-image: 
      /* MAJOR (Limonka) */
      linear-gradient(90deg, rgba(204, 255, 0, 0.5) 2px, transparent 2px),
      linear-gradient(180deg, rgba(204, 255, 0, 0.5) 2px, transparent 2px),

      /* MINOR (Białe) */
      linear-gradient(90deg, rgba(255, 255, 255, 0.07) 1px, transparent 1px),
      linear-gradient(180deg, rgba(255, 255, 255, 0.07) 1px, transparent 1px);

    background-size: 
      200px 200px, 
      200px 200px, 
      40px 40px, 
      40px 40px;

    animation: grid-fly 6s linear infinite;
    will-change: transform;
    backface-visibility: hidden;
  }

  @keyframes grid-fly {
    0% { transform: translateY(0); }
    100% { transform: translateY(200px); }
  }

  /* --- MOBILE OPTIMIZATION --- */
  @media (max-width: 768px) {
    .cyber-scene {
      perspective: 250px; 
      mask-image: linear-gradient(to bottom, transparent 0%, transparent 40%, black 80%, black 100%);
      -webkit-mask-image: linear-gradient(to bottom, transparent 0%, transparent 40%, black 80%, black 100%);
    }

    .grid-wrapper {
        transform: rotateX(75deg);
    }

    .grid-texture {
      /* ZMIANA KLUCZOWA DLA IMERSJI */
      /* Nadpisujemy background-image TYLKO dla mobile.
         Pierwszy gradient (Pionowe linie Major) ma teraz linię wycentrowaną wewnątrz kafelka.
         Dzięki temu, przy background-position: center, linia wypada idealnie na środku ekranu.
      */
      background-image: 
        /* 1. MAJOR VERTICAL (CENTERED) - To jest ta linia prowadząca */
        linear-gradient(90deg, transparent calc(50% - 1px), rgba(204, 255, 0, 0.5) 2px, transparent calc(50% + 1px)),
        
        /* 2. MAJOR HORIZONTAL - Bez zmian */
        linear-gradient(180deg, rgba(204, 255, 0, 0.5) 2px, transparent 2px),

        /* 3. MINOR VERTICAL */
        linear-gradient(90deg, rgba(255, 255, 255, 0.07) 1px, transparent 1px),
        /* 4. MINOR HORIZONTAL */
        linear-gradient(180deg, rgba(255, 255, 255, 0.07) 1px, transparent 1px);

      background-size: 
        100px 100px, 
        100px 100px,  
        20px 20px, 
        20px 20px;     
        
      animation: grid-fly-mobile 6s linear infinite;
    }
  }

  @keyframes grid-fly-mobile {
    0% { transform: translateY(0); }
    100% { transform: translateY(100px); }
  }
</style>